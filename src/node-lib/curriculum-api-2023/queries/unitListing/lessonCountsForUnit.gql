query lessonCountsForUnit($programmeSlug: String, $unitSlug: String) {
  lessonCount: published_mv_synthetic_unitvariant_lessons_by_keystage_6_0_0_aggregate(
    where: {
      programme_slug: { _eq: $programmeSlug }
      unit_slug: { _eq: $unitSlug }
      _not: {
        lesson_data: { _contains: { deprecated_fields: { expired: true } } }
      }
    }
  ) {
    aggregate {
      count(distinct: true, columns: lesson_slug)
    }
    nodes {
      unit_slug
      unit_data(path: "unit_id")
    }
  }
  expiredLessonCount: published_mv_synthetic_unitvariant_lessons_by_keystage_6_0_0_aggregate(
    where: {
      programme_slug: { _eq: $programmeSlug }
      unit_slug: { _eq: $unitSlug }
      lesson_data: { _contains: { deprecated_fields: { expired: true } } }
    }
  ) {
    aggregate {
      count(distinct: true, columns: lesson_slug)
    }
  }
}
